# SkyLayer控制器使用指南

## 概述

`SkyLayerController` 是一个专门为天空层设计的控制脚本，解决了天空贴图尺寸不对和缺乏自动移动的问题。

## 功能特性

### 1. 自动尺寸适配
- 自动检测屏幕尺寸并调整天空贴图缩放
- 确保天空贴图能够完全覆盖屏幕
- 保持贴图宽高比

### 2. 视差滚动设置
- 自动设置合适的视差滚动参数
- 天空层默认为水平移动(X轴)，垂直固定(Y轴)
- 可自定义视差移动比例

### 3. 自动移动系统
- 天空和云朵可以独立配置自动移动
- 即使摄像头静止，天空也能缓慢移动增强氛围感
- 可配置不同的移动速度

## 使用方法

### 基础使用

1. **添加脚本到SkyLayer节点**
   ```
   在Godot编辑器中：
   - 选择SkyLayer节点
   - 在Inspector中添加脚本: Scripts/Level/SkyLayerController.gd
   ```

2. **配置节点结构**
   ```
   SkyLayer (ParallaxLayer + SkyLayerController脚本)
   ├── SkySprites (Node2D)
   │   ├── Sky (Sprite2D) - 天空贴图
   │   └── Cloud1, Cloud2... (Sprite2D) - 云朵贴图 [可选]
   ```

### 参数配置

#### 自动移动设置
- **Enable Auto Movement**: 是否启用自动移动
- **Sky Move Speed**: 天空移动速度 (像素/秒)
- **Cloud Move Speed**: 云朵移动速度 (像素/秒)

#### 视差效果设置  
- **Enable Parallax**: 是否启用视差滚动
- **Custom Motion Scale**: 自定义视差比例 (建议: X=0.1, Y=0.0)

#### 贴图缩放设置
- **Auto Scale To Screen**: 是否自动缩放以适配屏幕
- **Min Scale Factor**: 最小缩放倍数 (确保覆盖屏幕)
- **Maintain Aspect Ratio**: 是否保持宽高比

## 实际效果

运行项目后，你会看到：

1. **天空尺寸正确**：天空贴图自动缩放至1.5倍，完全覆盖屏幕
2. **视差滚动生效**：摄像头移动时，天空以较慢速度跟随
3. **自动移动**：即使摄像头静止，天空也会缓慢向左移动
4. **云朵独立移动**：如果添加了云朵，会以不同速度移动

## 调试信息

脚本会在控制台输出详细的调试信息：
```
🌤️ [天空控制器] 初始化SkyLayer控制器
🎮 [天空控制器] 设置视差滚动: (0.1, 0.0)
📱 [天空控制器] 屏幕尺寸: (1920.0, 1080.0)
🌤️ [天空控制器] 找到天空贴图: Sky
🖼️ [天空控制器] 天空贴图原始尺寸: (2048.0, 1024.0)
🔧 [天空控制器] 天空贴图缩放至: (1.5, 1.5) (缩放因子: 1.50)
```

## 常见问题

### Q: 天空不移动怎么办？
A: 检查以下设置：
- `enable_auto_movement` 是否为 true
- `sky_move_speed` 是否大于 0
- 确保节点结构正确

### Q: 视差滚动不生效？
A: 检查以下设置：
- `enable_parallax` 是否为 true
- `custom_motion_scale` 的X值不为0
- ParallaxBackground节点是否存在

### Q: 天空尺寸还是不对？
A: 检查以下设置：
- `auto_scale_to_screen` 是否为 true
- 尝试调整 `min_scale_factor` 的值
- 确保贴图路径正确

## 进阶使用

### 添加云朵层
如果你想添加云朵效果：

1. 在SkySprites下创建多个Sprite2D节点
2. 将云朵贴图赋值给这些节点
3. 脚本会自动检测并应用不同的移动速度

### 自定义移动速度
可以根据关卡氛围调整速度：
- 平静场景：天空 3-5 像素/秒，云朵 8-10 像素/秒
- 紧张场景：天空 8-12 像素/秒，云朵 15-20 像素/秒

### 多层云朵效果
为了营造更丰富的视觉效果：
- 远景云朵：较慢速度，较大尺寸
- 近景云朵：较快速度，较小尺寸

## 注意事项

1. **贴图尺寸**：建议天空贴图至少为屏幕尺寸的1.5倍
2. **性能考虑**：自动移动会持续更新位置，但性能影响很小
3. **视觉一致性**：确保天空移动方向与游戏整体视觉风格一致

## 总结

SkyLayerController 提供了一个简单而强大的解决方案来管理天空层的视觉效果。通过合理配置参数，可以为游戏增添丰富的氛围感和动态效果。 
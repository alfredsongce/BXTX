# å…³å¡åœºæ™¯è¿ç§»æŒ‡å—

## 1. æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜å¦‚ä½•å°†ç°æœ‰BattleSceneä¸­çš„ç¡¬ç¼–ç å†…å®¹ï¼ˆè§’è‰²ç”Ÿæˆã€åœ°é¢è®¾ç½®ã€éšœç¢ç‰©é…ç½®ç­‰ï¼‰è¿ç§»åˆ°ç‹¬ç«‹çš„å…³å¡åœºæ™¯ä¸­ï¼Œå®ç°ç¬¦åˆGodotè®¾è®¡å“²å­¦çš„æ¨¡å—åŒ–å…³å¡ç³»ç»Ÿã€‚

### 1.1 è¿ç§»ç›®æ ‡
- å°†è§’è‰²ç”Ÿæˆé€»è¾‘ä»BattleCharacterManagerè¿ç§»åˆ°å…³å¡åœºæ™¯
- å°†åœ°é¢å’Œç¯å¢ƒè®¾ç½®ç§»è‡³å…³å¡é…ç½®
- å®ç°å…³å¡è®¾è®¡å¸ˆå¯ç‹¬ç«‹ç¼–è¾‘çš„å…³å¡ç³»ç»Ÿ
- ä¿æŒç°æœ‰æˆ˜æ–—ç³»ç»Ÿçš„å®Œæ•´æ€§

### 1.2 è¿ç§»åŸåˆ™
- **åˆ†ç¦»å…³æ³¨ç‚¹**: BattleSceneä¸“æ³¨äºæˆ˜æ–—ç³»ç»Ÿï¼Œå…³å¡åœºæ™¯ä¸“æ³¨äºå†…å®¹
- **æ•°æ®é©±åŠ¨**: ä½¿ç”¨é…ç½®æ–‡ä»¶è€Œéç¡¬ç¼–ç 
- **å¯å¤ç”¨æ€§**: å…³å¡æ¨¡æ¿å¯ä»¥è¢«å¤åˆ¶å’Œä¿®æ”¹
- **å‘åå…¼å®¹**: è¿ç§»è¿‡ç¨‹ä¸­ä¿æŒç°æœ‰åŠŸèƒ½æ­£å¸¸è¿è¡Œ

## 2. å½“å‰ç³»ç»Ÿåˆ†æ

### 2.1 éœ€è¦è¿ç§»çš„å†…å®¹

#### ä»BattleCharacterManagerä¸­è¿ç§»:
```gdscript
# å½“å‰åœ¨BattleCharacterManagerä¸­çš„ç¡¬ç¼–ç å†…å®¹
var party_member_ids = ["1", "2", "3"]  # å‹æ–¹è§’è‰²IDåˆ—è¡¨
var enemy_configs = [
    {"id": "101", "position": Vector2(1000, 1000)},
    {"id": "102", "position": Vector2(1100, 1000)},
    {"id": "103", "position": Vector2(1200, 1000)}
]

# ä½ç½®è®¡ç®—é€»è¾‘
func _setup_party_member_positions():
    # ç¡¬ç¼–ç çš„ä½ç½®è®¡ç®—
```

#### ä»BattleSceneä¸­è¿ç§»:
```gdscript
# å½“å‰åœ¨BattleSceneä¸­çš„å…³å¡åŠ è½½
func _load_initial_level():
    var level_scene = preload("res://Scenes/Levels/Level_1_åºå¹•.tscn")
    # ç¡¬ç¼–ç çš„å…³å¡é€‰æ‹©é€»è¾‘
```

#### ä»å…¶ä»–ç³»ç»Ÿä¸­è¿ç§»:
- åœ°é¢é«˜åº¦é…ç½®
- éšœç¢ç‰©å¸ƒå±€
- ç‰¹æ®Šåœ°å½¢è®¾ç½®
- ç¯å¢ƒå…‰ç…§é…ç½®

### 2.2 å½“å‰æ•°æ®æµ

```
BattleScene._ready()
    â†“
BattleCharacterManager.initialize()
    â†“
ç¡¬ç¼–ç è§’è‰²åˆ—è¡¨ â†’ ç”Ÿæˆè§’è‰²èŠ‚ç‚¹
    â†“
ç¡¬ç¼–ç ä½ç½® â†’ è®¾ç½®è§’è‰²ä½ç½®
    â†“
å…³å¡åœºæ™¯æŒ‚è½½ â†’ éšœç¢ç‰©åŠ è½½
```

## 3. ç›®æ ‡æ¶æ„è®¾è®¡

### 3.1 æ–°çš„æ•°æ®æµ

```
BattleScene._ready()
    â†“
åŠ è½½å…³å¡åœºæ™¯ â†’ LevelConfiguration.gd
    â†“
è¯»å–å…³å¡é…ç½® â†’ è§’è‰²é…ç½®ã€ä½ç½®é…ç½®
    â†“
BattleCharacterManager.load_from_level_config()
    â†“
åŠ¨æ€ç”Ÿæˆè§’è‰² â†’ æˆ˜æ–—å¼€å§‹
```

### 3.2 å…³å¡é…ç½®ç³»ç»Ÿ

#### LevelConfiguration.gd (å…³å¡é…ç½®è„šæœ¬)
```gdscript
extends Node
class_name LevelConfiguration

# å…³å¡åŸºç¡€ä¿¡æ¯
@export var level_name: String = "åºå¹•"
@export var level_id: String = "level_1"
@export var description: String = "æ¸¸æˆå¼€å§‹çš„åºå¹•å…³å¡"

# è§’è‰²é…ç½®
@export_group("è§’è‰²é…ç½®")
@export var player_character_ids: Array[String] = ["1", "2", "3"]
@export var enemy_configurations: Array[EnemyConfig] = []

# ç¯å¢ƒé…ç½®
@export_group("ç¯å¢ƒé…ç½®") 
@export var ground_height: float = 1000.0
@export var gravity_scale: float = 1.0
@export var ambient_light_color: Color = Color.WHITE

# è§†è§‰é…ç½®
@export_group("è§†è§‰é…ç½®")
@export var background_music: AudioStream
@export var ambient_sound: AudioStream
@export var weather_effects: Array[String] = []

# è·å–è§’è‰²ç”Ÿæˆç‚¹
func get_player_spawn_points() -> Array[Vector2]:
    var spawns = []
    var spawn_nodes = get_node_or_null("../GameplayLayers/CharacterSpawns/PlayerSpawns")
    if spawn_nodes:
        for child in spawn_nodes.get_children():
            if child is Marker2D:
                spawns.append(child.global_position)
    return spawns

func get_enemy_spawn_points() -> Array[Vector2]:
    var spawns = []
    var spawn_nodes = get_node_or_null("../GameplayLayers/CharacterSpawns/EnemySpawns")
    if spawn_nodes:
        for child in spawn_nodes.get_children():
            if child is Marker2D:
                spawns.append(child.global_position)
    return spawns
```

#### EnemyConfig.gd (æ•Œäººé…ç½®èµ„æº)
```gdscript
extends Resource
class_name EnemyConfig

@export var enemy_id: String
@export var spawn_index: int = 0  # å¯¹åº”EnemySpawnèŠ‚ç‚¹çš„ç´¢å¼•
@export var level_override: int = -1  # -1è¡¨ç¤ºä½¿ç”¨é»˜è®¤ç­‰çº§
@export var custom_ai_behavior: String = ""
@export var special_abilities: Array[String] = []
```

## 4. è¿ç§»æ­¥éª¤

### 4.1 ç¬¬ä¸€é˜¶æ®µï¼šåˆ›å»ºå…³å¡é…ç½®ç³»ç»Ÿ

#### 1. åˆ›å»ºLevelConfigurationè„šæœ¬
```gdscript
# Scripts/Level/LevelConfiguration.gd
extends Node
class_name LevelConfiguration

@export var level_name: String = ""
@export var player_character_ids: Array[String] = []
@export var enemy_configurations: Array[EnemyConfig] = []

signal level_data_ready(config: LevelConfiguration)

func _ready():
    # éªŒè¯é…ç½®æ•°æ®
    if validate_configuration():
        level_data_ready.emit(self)
    else:
        printerr("å…³å¡é…ç½®éªŒè¯å¤±è´¥: " + level_name)

func validate_configuration() -> bool:
    if player_character_ids.is_empty():
        printerr("ç©å®¶è§’è‰²åˆ—è¡¨ä¸èƒ½ä¸ºç©º")
        return false
    return true

func get_player_spawn_points() -> Array[Vector2]:
    # å®ç°ä»£ç ...
    pass

func get_enemy_spawn_points() -> Array[Vector2]:
    # å®ç°ä»£ç ...
    pass
```

#### 2. åˆ›å»ºEnemyConfigèµ„æº
```gdscript
# Scripts/Level/EnemyConfig.gd
extends Resource
class_name EnemyConfig

@export var enemy_id: String
@export var spawn_index: int = 0
@export var level_override: int = -1
```

### 4.2 ç¬¬äºŒé˜¶æ®µï¼šä¿®æ”¹LEVEL_1_åºå¹•.tscn

#### 1. é‡æ„åœºæ™¯ç»“æ„
æŒ‰ç…§å¤šå±‚èƒŒæ™¯ç³»ç»Ÿæ–‡æ¡£ä¸­çš„å…³å¡åœºæ™¯ç»“æ„é‡æ–°ç»„ç»‡èŠ‚ç‚¹ï¼š

```
LevelRoot (Node2D)
â”œâ”€â”€ BackgroundLayers (CanvasLayer)
â”œâ”€â”€ GameplayLayers (Node2D)
â”‚   â”œâ”€â”€ GroundLayer (Node2D)
â”‚   â”œâ”€â”€ ObstacleLayer (Node2D)
â”‚   â”‚   â””â”€â”€ Obstacles (Node2D)
â”‚   â”‚       â””â”€â”€ [ç§»åŠ¨ç°æœ‰çš„ObstacleèŠ‚ç‚¹åˆ°è¿™é‡Œ]
â”‚   â”œâ”€â”€ CharacterSpawns (Node2D)
â”‚   â”‚   â”œâ”€â”€ PlayerSpawns (Node2D)
â”‚   â”‚   â”‚   â”œâ”€â”€ PlayerSpawn1 (Marker2D) [position: (600, 1000)]
â”‚   â”‚   â”‚   â”œâ”€â”€ PlayerSpawn2 (Marker2D) [position: (700, 1000)]
â”‚   â”‚   â”‚   â””â”€â”€ PlayerSpawn3 (Marker2D) [position: (800, 1000)]
â”‚   â”‚   â””â”€â”€ EnemySpawns (Node2D)
â”‚   â”‚       â”œâ”€â”€ EnemySpawn1 (Marker2D) [position: (1000, 1000)]
â”‚   â”‚       â”œâ”€â”€ EnemySpawn2 (Marker2D) [position: (1100, 1000)]
â”‚   â”‚       â””â”€â”€ EnemySpawn3 (Marker2D) [position: (1200, 1000)]
â”œâ”€â”€ ForegroundLayers (CanvasLayer)
â””â”€â”€ LevelConfiguration (Node)
    â””â”€â”€ LevelData (æŒ‚è½½LevelConfiguration.gdè„šæœ¬)
```

#### 2. é…ç½®LevelConfigurationèŠ‚ç‚¹
åœ¨Godotç¼–è¾‘å™¨ä¸­è®¾ç½®LevelConfigurationèŠ‚ç‚¹çš„å¯¼å‡ºå±æ€§ï¼š
- **level_name**: "åºå¹•"
- **level_id**: "level_1"
- **player_character_ids**: ["1", "2", "3"]
- **enemy_configurations**: 
  - EnemyConfig 1: enemy_id="101", spawn_index=0
  - EnemyConfig 2: enemy_id="102", spawn_index=1  
  - EnemyConfig 3: enemy_id="103", spawn_index=2

### 4.3 ç¬¬ä¸‰é˜¶æ®µï¼šä¿®æ”¹BattleCharacterManager

#### 1. æ·»åŠ å…³å¡é…ç½®æ”¯æŒ
```gdscript
# åœ¨BattleCharacterManagerä¸­æ·»åŠ 
var current_level_config: LevelConfiguration
var level_spawned_characters: Dictionary = {}

func load_from_level_config(level_config: LevelConfiguration):
    current_level_config = level_config
    
    print("ğŸ® [è§’è‰²ç®¡ç†å™¨] ä»å…³å¡é…ç½®åŠ è½½è§’è‰²")
    print("å…³å¡åç§°: " + level_config.level_name)
    
    # æ¸…é™¤ç°æœ‰è§’è‰²
    clear_existing_characters()
    
    # åŠ è½½ç©å®¶è§’è‰²
    await load_player_characters()
    
    # åŠ è½½æ•Œäººè§’è‰²
    await load_enemy_characters()
    
    print("âœ… [è§’è‰²ç®¡ç†å™¨] å…³å¡è§’è‰²åŠ è½½å®Œæˆ")

func load_player_characters():
    var spawn_points = current_level_config.get_player_spawn_points()
    var character_ids = current_level_config.player_character_ids
    
    for i in range(character_ids.size()):
        var character_id = character_ids[i]
        var spawn_position = spawn_points[i] if i < spawn_points.size() else Vector2.ZERO
        
        print("ğŸ¯ [è§’è‰²ç®¡ç†å™¨] ç”Ÿæˆç©å®¶è§’è‰²: ID=%s, ä½ç½®=%s" % [character_id, spawn_position])
        
        # ä½¿ç”¨ç°æœ‰çš„è§’è‰²ç”Ÿæˆé€»è¾‘ï¼Œä½†ä½¿ç”¨é…ç½®çš„ä½ç½®
        var character_node = await create_character_node(character_id, true)
        if character_node:
            character_node.global_position = spawn_position
            level_spawned_characters[character_id] = character_node

func load_enemy_characters():
    var spawn_points = current_level_config.get_enemy_spawn_points()
    
    for enemy_config in current_level_config.enemy_configurations:
        var spawn_position = spawn_points[enemy_config.spawn_index] if enemy_config.spawn_index < spawn_points.size() else Vector2.ZERO
        
        print("ğŸ¯ [è§’è‰²ç®¡ç†å™¨] ç”Ÿæˆæ•Œäººè§’è‰²: ID=%s, ä½ç½®=%s" % [enemy_config.enemy_id, spawn_position])
        
        var character_node = await create_character_node(enemy_config.enemy_id, false)
        if character_node:
            character_node.global_position = spawn_position
            level_spawned_characters[enemy_config.enemy_id] = character_node

func clear_existing_characters():
    # æ¸…é™¤ç°æœ‰çš„ç¡¬ç¼–ç è§’è‰²
    for child in party_member_nodes.values():
        if child:
            child.queue_free()
    for child in enemy_nodes.values():
        if child:
            child.queue_free()
            
    party_member_nodes.clear()
    enemy_nodes.clear()
    level_spawned_characters.clear()
```

#### 2. é‡æ„ç°æœ‰çš„è§’è‰²ç”Ÿæˆæ–¹æ³•
```gdscript
# å°†ç°æœ‰çš„generate_party_members()ç­‰æ–¹æ³•æ ‡è®°ä¸ºå¼ƒç”¨
# åˆ›å»ºæ–°çš„é€šç”¨è§’è‰²ç”Ÿæˆæ–¹æ³•

func create_character_node(character_id: String, is_player: bool) -> Node:
    # é‡ç”¨ç°æœ‰çš„è§’è‰²åˆ›å»ºé€»è¾‘ï¼Œä½†ç§»é™¤ç¡¬ç¼–ç éƒ¨åˆ†
    print("ğŸ”§ [è§’è‰²ç®¡ç†å™¨] åˆ›å»ºè§’è‰²èŠ‚ç‚¹: ID=%s, æ˜¯å¦ç©å®¶=%s" % [character_id, is_player])
    
    # ä½¿ç”¨ç°æœ‰çš„è§’è‰²åˆ›å»ºé€»è¾‘...
    var character_scene = preload("res://Prefabs/BattleCharacter.tscn")
    var character_node = character_scene.instantiate()
    
    # è®¾ç½®è§’è‰²æ•°æ®...
    var character_data = await load_character_data(character_id)
    character_node.set_character_data(character_data)
    
    # æ·»åŠ åˆ°ç›¸åº”çš„å®¹å™¨
    if is_player:
        add_child(character_node)
        party_member_nodes[character_id] = character_node
    else:
        add_child(character_node)
        enemy_nodes[character_id] = character_node
    
    return character_node
```

### 4.4 ç¬¬å››é˜¶æ®µï¼šä¿®æ”¹BattleScene

#### 1. ä¿®æ”¹å…³å¡åŠ è½½é€»è¾‘
```gdscript
# åœ¨BattleSceneä¸­ä¿®æ”¹
func _ready():
    # ... ç°æœ‰åˆå§‹åŒ–ä»£ç  ...
    
    # åŠ è½½å…³å¡åœºæ™¯
    await load_dynamic_level()

func load_dynamic_level(level_path: String = "res://Scenes/Levels/Level_1_åºå¹•.tscn"):
    print("ğŸ® [æˆ˜æ–—åœºæ™¯] åŠ è½½åŠ¨æ€å…³å¡: " + level_path)
    
    var level_scene = load(level_path)
    if not level_scene:
        printerr("âŒ [æˆ˜æ–—åœºæ™¯] æ— æ³•åŠ è½½å…³å¡åœºæ™¯: " + level_path)
        return
    
    var level_instance = level_scene.instantiate()
    var dynamics_level = get_node("DynamicsLevel")
    dynamics_level.add_child(level_instance)
    
    # æŸ¥æ‰¾å¹¶è¿æ¥å…³å¡é…ç½®
    var level_config = level_instance.get_node_or_null("LevelConfiguration/LevelData")
    if level_config and level_config is LevelConfiguration:
        level_config.level_data_ready.connect(_on_level_data_ready)
        print("âœ… [æˆ˜æ–—åœºæ™¯] å…³å¡é…ç½®è¿æ¥æˆåŠŸ")
    else:
        printerr("âš ï¸ [æˆ˜æ–—åœºæ™¯] æœªæ‰¾åˆ°å…³å¡é…ç½®èŠ‚ç‚¹")

func _on_level_data_ready(config: LevelConfiguration):
    print("ğŸ¯ [æˆ˜æ–—åœºæ™¯] å…³å¡æ•°æ®å‡†å¤‡å°±ç»ª: " + config.level_name)
    
    # é€šçŸ¥è§’è‰²ç®¡ç†å™¨åŠ è½½è§’è‰²
    if character_manager:
        await character_manager.load_from_level_config(config)
    
    # å…¶ä»–ç³»ç»Ÿåˆå§‹åŒ–...
    await initialize_other_systems_with_level(config)
    
    print("âœ… [æˆ˜æ–—åœºæ™¯] å…³å¡åˆå§‹åŒ–å®Œæˆ")

func initialize_other_systems_with_level(config: LevelConfiguration):
    # åˆå§‹åŒ–å…¶ä»–éœ€è¦å…³å¡é…ç½®çš„ç³»ç»Ÿ
    if battle_manager:
        battle_manager.set_level_configuration(config)
    
    # è®¾ç½®ç¯å¢ƒå‚æ•°
    setup_level_environment(config)

func setup_level_environment(config: LevelConfiguration):
    # è®¾ç½®é‡åŠ›ã€å…‰ç…§ç­‰ç¯å¢ƒå‚æ•°
    if config.gravity_scale != 1.0:
        PhysicsServer2D.area_set_param(
            get_viewport().find_world_2d().space,
            PhysicsServer2D.AREA_PARAM_GRAVITY_SCALE,
            config.gravity_scale
        )
```

### 4.5 ç¬¬äº”é˜¶æ®µï¼šæ•°æ®è¿ç§»

#### 1. è¿ç§»ç°æœ‰è§’è‰²é…ç½®
å°†BattleCharacterManagerä¸­çš„ç¡¬ç¼–ç è§’è‰²åˆ—è¡¨è¿ç§»åˆ°å…³å¡é…ç½®ï¼š

```gdscript
# ä»è¿™ä¸ªç¡¬ç¼–ç é…ç½®:
var party_member_ids = ["1", "2", "3"]
var enemy_configs = [
    {"id": "101", "position": Vector2(1000, 1000)},
    {"id": "102", "position": Vector2(1100, 1000)}, 
    {"id": "103", "position": Vector2(1200, 1000)}
]

# è¿ç§»åˆ°å…³å¡åœºæ™¯çš„LevelConfigurationé…ç½®å’ŒMarker2Dä½ç½®
```

#### 2. åˆ›å»ºå…³å¡æ¨¡æ¿
```gdscript
# Scripts/Level/LevelTemplate.gd
# ç”¨äºå¿«é€Ÿåˆ›å»ºæ–°å…³å¡çš„æ¨¡æ¿è„šæœ¬

extends EditorScript

func _run():
    create_level_template("NewLevel")

func create_level_template(level_name: String):
    var level_scene = PackedScene.new()
    
    # åˆ›å»ºåŸºç¡€èŠ‚ç‚¹ç»“æ„...
    var root = Node2D.new()
    root.name = "LevelRoot"
    
    # æ·»åŠ å„å±‚çº§èŠ‚ç‚¹...
    setup_background_layers(root)
    setup_gameplay_layers(root)
    setup_foreground_layers(root)
    setup_level_configuration(root, level_name)
    
    # ä¿å­˜åœºæ™¯
    level_scene.pack(root)
    ResourceSaver.save(level_scene, "res://Scenes/Levels/" + level_name + ".tscn")
```

## 5. æµ‹è¯•å’ŒéªŒè¯

### 5.1 è¿ç§»éªŒè¯æ¸…å•

- [ ] å…³å¡åœºæ™¯å¯ä»¥ç‹¬ç«‹æ‰“å¼€å’Œç¼–è¾‘
- [ ] è§’è‰²ç”Ÿæˆç‚¹ä½ç½®æ­£ç¡®
- [ ] è§’è‰²é…ç½®å¯ä»¥åœ¨ç¼–è¾‘å™¨ä¸­ä¿®æ”¹
- [ ] æˆ˜æ–—ç³»ç»Ÿä»ç„¶æ­£å¸¸å·¥ä½œ
- [ ] éšœç¢ç‰©ç³»ç»Ÿä¿æŒåŠŸèƒ½
- [ ] èƒŒæ™¯ç³»ç»Ÿæ­£å¸¸æ˜¾ç¤º

### 5.2 æµ‹è¯•æ­¥éª¤

1. **ç‹¬ç«‹å…³å¡æµ‹è¯•**
   ```gdscript
   # åˆ›å»ºæµ‹è¯•è„šæœ¬éªŒè¯å…³å¡å¯ç‹¬ç«‹è¿è¡Œ
   func test_level_standalone():
       var level = preload("res://Scenes/Levels/Level_1_åºå¹•.tscn").instantiate()
       add_child(level)
       
       var config = level.get_node("LevelConfiguration/LevelData")
       assert(config != null, "å…³å¡é…ç½®èŠ‚ç‚¹å­˜åœ¨")
       assert(config.player_character_ids.size() > 0, "ç©å®¶è§’è‰²é…ç½®éç©º")
   ```

2. **è§’è‰²ç”Ÿæˆæµ‹è¯•**
   ```gdscript
   func test_character_spawning():
       # éªŒè¯è§’è‰²æ˜¯å¦åœ¨æ­£ç¡®ä½ç½®ç”Ÿæˆ
       # éªŒè¯è§’è‰²æ•°æ®æ˜¯å¦æ­£ç¡®åŠ è½½
   ```

3. **æˆ˜æ–—ç³»ç»Ÿé›†æˆæµ‹è¯•**
   ```gdscript
   func test_battle_integration():
       # éªŒè¯æˆ˜æ–—ç³»ç»Ÿæ˜¯å¦èƒ½æ­£ç¡®è¯†åˆ«å…³å¡ç”Ÿæˆçš„è§’è‰²
       # éªŒè¯æŠ€èƒ½ç³»ç»Ÿã€ç§»åŠ¨ç³»ç»Ÿç­‰æ˜¯å¦æ­£å¸¸
   ```

## 6. è¿›é˜¶åŠŸèƒ½

### 6.1 å…³å¡ç¼–è¾‘å™¨å·¥å…·

```gdscript
# Scripts/Tools/LevelEditor.gd
@tool
extends EditorPlugin

func handles(object):
    return object is LevelConfiguration

func edit(object):
    # åˆ›å»ºè‡ªå®šä¹‰çš„å…³å¡ç¼–è¾‘ç•Œé¢
    var editor = preload("res://Tools/LevelConfigEditor.tscn").instantiate()
    editor.edit_configuration(object)
    return editor
```

### 6.2 å…³å¡éªŒè¯ç³»ç»Ÿ

```gdscript
# Scripts/Level/LevelValidator.gd
extends RefCounted
class_name LevelValidator

static func validate_level(level_config: LevelConfiguration) -> Array[String]:
    var errors = []
    
    # éªŒè¯è§’è‰²é…ç½®
    if level_config.player_character_ids.is_empty():
        errors.append("ç©å®¶è§’è‰²åˆ—è¡¨ä¸èƒ½ä¸ºç©º")
    
    # éªŒè¯ç”Ÿæˆç‚¹æ•°é‡
    var player_spawns = level_config.get_player_spawn_points()
    if player_spawns.size() < level_config.player_character_ids.size():
        errors.append("ç©å®¶ç”Ÿæˆç‚¹æ•°é‡ä¸è¶³")
    
    return errors
```

### 6.3 å…³å¡åºåˆ—åŒ–

```gdscript
# Scripts/Level/LevelSerializer.gd
# æ”¯æŒå°†å…³å¡é…ç½®åºåˆ—åŒ–ä¸ºJSONï¼Œä¾¿äºç‰ˆæœ¬æ§åˆ¶å’Œç¼–è¾‘

func export_level_to_json(level_config: LevelConfiguration) -> String:
    var data = {
        "level_name": level_config.level_name,
        "player_characters": level_config.player_character_ids,
        "enemy_configs": serialize_enemy_configs(level_config.enemy_configurations)
    }
    return JSON.stringify(data)

func import_level_from_json(json_string: String) -> LevelConfiguration:
    # ä»JSONæ¢å¤å…³å¡é…ç½®
    pass
```

## 7. è¿ç§»æ—¶é—´è¡¨

### é˜¶æ®µä¸€ (1-2å¤©)
- åˆ›å»ºLevelConfigurationè„šæœ¬
- åˆ›å»ºEnemyConfigèµ„æº
- è®¾ç½®åŸºç¡€å…³å¡åœºæ™¯ç»“æ„

### é˜¶æ®µäºŒ (2-3å¤©)  
- ä¿®æ”¹LEVEL_1_åºå¹•.tscnåœºæ™¯ç»“æ„
- æ·»åŠ è§’è‰²ç”Ÿæˆç‚¹Marker2DèŠ‚ç‚¹
- é…ç½®å…³å¡å‚æ•°

### é˜¶æ®µä¸‰ (3-4å¤©)
- ä¿®æ”¹BattleCharacterManageræ”¯æŒå…³å¡é…ç½®
- é‡æ„è§’è‰²ç”Ÿæˆé€»è¾‘
- æµ‹è¯•è§’è‰²ç”ŸæˆåŠŸèƒ½

### é˜¶æ®µå›› (2-3å¤©)
- ä¿®æ”¹BattleSceneå…³å¡åŠ è½½é€»è¾‘
- é›†æˆæµ‹è¯•æ•´ä¸ªç³»ç»Ÿ
- ä¿®å¤å‘ç°çš„é—®é¢˜

### é˜¶æ®µäº” (1-2å¤©)
- åˆ›å»ºå…³å¡ç¼–è¾‘å·¥å…·
- ç¼–å†™æ–‡æ¡£å’Œæµ‹è¯•ç”¨ä¾‹
- ä»£ç æ¸…ç†å’Œä¼˜åŒ–

## 8. æ€»ç»“

é€šè¿‡è¿™ä¸ªè¿ç§»æŒ‡å—ï¼Œæˆ‘ä»¬å°†å®ç°ï¼š

1. **å…³å¡è®¾è®¡å¸ˆå‹å¥½**: å¯ä»¥åœ¨Godotç¼–è¾‘å™¨ä¸­ç›´æ¥ç¼–è¾‘å…³å¡å†…å®¹
2. **æ•°æ®é©±åŠ¨**: è§’è‰²é…ç½®ã€ä½ç½®ç­‰é€šè¿‡é…ç½®æ–‡ä»¶è€Œéç¡¬ç¼–ç 
3. **æ¨¡å—åŒ–**: å…³å¡ä¸æˆ˜æ–—ç³»ç»Ÿåˆ†ç¦»ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•
4. **å¯å¤ç”¨**: å…³å¡æ¨¡æ¿å¯ä»¥å¿«é€Ÿåˆ›å»ºæ–°å…³å¡

è¿™ä¸ªæ¶æ„å°†å¤§å¤§æå‡å¼€å‘æ•ˆç‡ï¼Œä½¿å¾—å…³å¡å†…å®¹çš„åˆ¶ä½œæ›´åŠ çµæ´»å’Œç›´è§‚ã€‚ 